<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>學期資料填寫</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background-color: #f9fdfb;
    margin: 0;
    padding: 20px;
    color: #333;
  }
  label {
    font-weight: bold;
    display: block;
    margin-top: 15px;
    margin-bottom: 8px;
    color: #004d40;
    font-size: 1.05em;
  }
  .radio-group {
    margin-left: 20px;
  }
  .hidden {
    display: none;
  }
  button {
    margin-top: 20px;
    padding: 10px 20px;
    background-color: #00796b;
    color: white;
    border: none;
    font-size: 1em;
    cursor: pointer;
    border-radius: 5px;
  }
  button:hover {
    background-color: #004d40;
  }
  .success {
    margin-top: 20px;
    padding: 15px;
    background-color: #2196f3;
    color: white;
    font-size: 1.2em;
    text-align: center;
    border-radius: 5px;
  }
</style>
</head>
<body>

<h2>學期資料填寫表</h2>

<form id="schoolForm">
  <label>1. 學生姓名</label>
  <input type="text" name="studentName" required>

  <label>2. 本學期午餐繳費方式</label>
  <div class="radio-group">
    <label><input type="radio" name="lunchPayment" value="全繳"> 全繳（與註冊費一起繳交）</label>
    <label><input type="radio" name="lunchPayment" value="月繳"> 月繳</label>
    <label><input type="radio" name="lunchPayment" value="領有午餐補助證明"> 領有午餐補助證明</label>
  </div>

  <label>3. 本學期午餐飲用的乳品</label>
  <div class="radio-group">
    <label><input type="radio" name="milkType" value="鮮乳"> 鮮乳</label>
    <label><input type="radio" name="milkType" value="調味乳"> 調味乳</label>
    <label><input type="radio" name="milkType" value="豆漿"> 豆漿</label>
  </div>

  <label>4. 本學期放學接送方式</label>
  <div class="radio-group">
    <label><input type="radio" name="pickupMethod" value="家長接送"> 家長接送</label>
    <label><input type="radio" name="pickupMethod" value="安親班" id="cramSchoolOption"> 安親班</label>
    <div id="cramSchoolFields" class="hidden">
      <label>安親班名稱</label>
      <input type="text" name="cramSchoolName">
      <label>安親班電話</label>
      <input type="text" name="cramSchoolPhone">
    </div>
    <label><input type="radio" name="pickupMethod" value="課後照顧班"> 課後照顧班</label>
  </div>

  <button type="submit">送出</button>
</form>

<div id="successMessage" class="success hidden">資料送出成功</div>

<script>
document.addEventListener("DOMContentLoaded", function () {
  const cramSchoolOption = document.getElementById("cramSchoolOption");
  const cramSchoolFields = document.getElementById("cramSchoolFields");
  const form = document.getElementById("schoolForm");
  const successMessage = document.getElementById("successMessage");

  // 顯示/隱藏安親班欄位
  form.addEventListener("change", function (e) {
    if (cramSchoolOption.checked) {
      cramSchoolFields.classList.remove("hidden");
    } else {
      cramSchoolFields.classList.add("hidden");
    }
  });

  // 表單送出
  form.addEventListener("submit", function (e) {
    e.preventDefault();

    const formData = new FormData(form);
    const data = {};
    formData.forEach((value, key) => {
      data[key] = value;
    });

    fetch("https://script.google.com/macros/s/AKfycbyWZdeFxVuIKsNJs8M36LNxL-IwIivcWc9wEcCtu8mvqZ20YpbcIYHPFuGfzN_ytSST/exec", {
      method: "POST",
      body: JSON.stringify(data),
      headers: {
        "Content-Type": "application/json"
      }
    })
    .then(res => res.text())
    .then(response => {
      if (response.trim() === "SUCCESS") {
        successMessage.classList.remove("hidden");
        form.reset();
        cramSchoolFields.classList.add("hidden");
      } else {
        alert("送出失敗：" + response);
      }
    })
    .catch(err => alert("送出失敗：" + err));
  });
});
</script>

</body>
</html>
