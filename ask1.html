<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>學生資料表單</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background-color: #f2f9f8;
    color: #333;
    max-width: 800px;
    margin: auto;
    padding: 20px;
  }
  h2 {
    color: #00695c;
    border-bottom: 2px solid #004d40;
    padding-bottom: 5px;
  }
  label {
    font-weight: bold;
    display: block;
    margin-top: 15px;
    margin-bottom: 8px;
    color: #004d40;
    font-size: 1.05em;
  }
  input[type="text"], input[type="tel"], select {
    width: 100%;
    padding: 8px;
    margin-top: 3px;
    border: 1px solid #ccc;
    border-radius: 5px;
  }
  .radio-group {
    margin-left: 20px;
    margin-top: 5px;
  }
  .sub-field {
    margin-left: 40px;
    margin-top: 5px;
  }
  button {
    background-color: #00796b;
    color: white;
    padding: 10px 20px;
    margin-top: 20px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-size: 1em;
  }
  button:hover {
    background-color: #004d40;
  }
  .success-message {
    display: none;
    background-color: #1976d2;
    color: white;
    padding: 15px;
    text-align: center;
    font-size: 1.2em;
    border-radius: 5px;
    margin-top: 20px;
  }
</style>
</head>
<body>

<h2>學生資料填寫表單</h2>

<form id="studentForm">
  <label>1. 學生姓名:</label>
  <input type="text" name="studentName" required>

  <label>2. 本學期午餐繳費方式</label>
  <div class="radio-group">
    <label><input type="radio" name="lunchPay" value="全繳（與註冊費一起繳交）" required> 全繳（與註冊費一起繳交）</label>
    <label><input type="radio" name="lunchPay" value="月繳"> 月繳</label>
    <label><input type="radio" name="lunchPay" value="領有午餐補助證明"> 領有午餐補助證明</label>
  </div>

  <label>3. 本學期午餐飲用的乳品</label>
  <div class="radio-group">
    <label><input type="radio" name="milkType" value="高大鮮乳" required> 高大鮮乳</label>
    <label><input type="radio" name="milkType" value="林鳳營低脂鮮乳"> 林鳳營低脂鮮乳</label>
    <label><input type="radio" name="milkType" value="無"> 無</label>
  </div>

  <label>4. 本學期放學接送方式</label>
  <div class="radio-group">
    <label><input type="radio" name="pickupMethod" value="家長接送" required> 家長接送</label>
    <label><input type="radio" name="pickupMethod" value="安親班" id="afterSchoolOption"> 安親班</label>
    <div id="afterSchoolFields" style="display:none;">
      <div class="sub-field">
        <label>安親班名稱</label>
        <input type="text" name="afterSchoolName">
      </div>
      <div class="sub-field">
        <label>安親班電話</label>
        <input type="tel" name="afterSchoolPhone">
      </div>
    </div>
    <label><input type="radio" name="pickupMethod" value="課後照顧班"> 課後照顧班</label>
  </div>

  <button type="submit">送出</button>
</form>

<div class="success-message" id="successMessage">資料送出成功</div>

<script>
  document.querySelectorAll('input[name="pickupMethod"]').forEach(el => {
    el.addEventListener('change', function() {
      document.getElementById('afterSchoolFields').style.display = 
        (this.value === '安親班') ? 'block' : 'none';
    });
  });

  document.getElementById('studentForm').addEventListener('submit', function(e) {
    e.preventDefault();

    const formData = new FormData(this);
    const data = {};
    formData.forEach((value, key) => { data[key] = value });

    // 你的 Apps Script 部署網址
    const scriptUrl = "https://script.google.com/macros/s/AKfycbyWZdeFxVuIKsNJs8M36LNxL-IwIivcWc9wEcCtu8mvqZ20YpbcIYHPFuGfzN_ytSST/exec";

    fetch(scriptUrl, {
      method: 'POST',
      body: JSON.stringify(data),
      headers: { 'Content-Type': 'application/json' }
    })
    .then(res => res.text())
    .then(() => {
      document.getElementById('successMessage').style.display = 'block';
      document.getElementById('studentForm').reset();
      document.getElementById('afterSchoolFields').style.display = 'none';
    })
    .catch(err => console.error('送出失敗', err));
  });
</script>

</body>
</html>
