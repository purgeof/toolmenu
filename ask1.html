<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>學生資料填寫</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background-color: #f8f9fa;
    padding: 20px;
    line-height: 1.6;
  }
  h2 {
    color: #00695c;
  }
  label {
    font-weight: bold;
    display: block;
    margin-top: 15px;
    margin-bottom: 8px;
    color: #004d40;
    font-size: 1.05em;
  }
  .indent {
    margin-left: 20px;
  }
  input[type="text"], input[type="tel"], select {
    padding: 6px;
    font-size: 1em;
    width: 250px;
    max-width: 100%;
    margin-top: 4px;
  }
  input[type="radio"], input[type="checkbox"] {
    margin-right: 6px;
  }
  button {
    margin-top: 20px;
    padding: 10px 18px;
    font-size: 1.05em;
    background-color: #0069d9;
    border: none;
    color: white;
    border-radius: 5px;
    cursor: pointer;
  }
  button:hover {
    background-color: #0053ba;
  }
  #successMessage {
    display: none;
    background-color: #007bff;
    color: white;
    padding: 10px;
    margin-top: 20px;
    font-size: 1.2em;
    text-align: center;
    border-radius: 5px;
  }
  .inline-group {
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
    margin-left: 20px;
  }
</style>
</head>
<body>

<h2>學生資料填寫表單</h2>

<form id="studentForm">

  <!-- 1 -->
  <label>1. 學生姓名:</label>
  <input type="text" name="studentName" required>

  <!-- 2 -->
  <label>2. 本學期午餐繳費方式</label>
  <div class="indent">
    <label><input type="radio" name="lunchPayment" value="全繳" required> 全繳（與註冊費一起繳交）</label>
    <label><input type="radio" name="lunchPayment" value="月繳"> 月繳</label>
    <label><input type="radio" name="lunchPayment" value="領有午餐補助證明"> 領有午餐補助證明</label>
  </div>

  <!-- 3 -->
  <label>3. 本學期午餐飲用的乳品</label>
  <div class="indent">
    <label><input type="radio" name="milkType" value="高大鮮乳" required> 高大鮮乳</label>
    <label><input type="radio" name="milkType" value="瑞穗鮮乳"> 瑞穗鮮乳</label>
    <label><input type="radio" name="milkType" value="其他"> 其他</label>
  </div>

  <!-- 4 -->
  <label>4. 本學期放學接送方式</label>
  <div class="indent">
    <label><input type="radio" name="pickupMethod" value="家長接送" required> 家長接送</label>
    <label><input type="radio" name="pickupMethod" value="安親班" id="cramSchoolOption"> 安親班</label>
    <div id="afterSchoolFields" style="display:none; margin-left:20px;">
      <label>安親班名稱</label>
      <input type="text" name="cramSchoolName">
      <label>安親班電話</label>
      <input type="tel" name="cramSchoolPhone">
    </div>
    <label><input type="radio" name="pickupMethod" value="課後照顧班"> 課後照顧班</label>
  </div>

  <button type="submit">送出</button>
</form>

<div id="successMessage">資料送出成功</div>

<script>
document.addEventListener("DOMContentLoaded", function() {
  const cramSchoolOption = document.getElementById("cramSchoolOption");
  const afterSchoolFields = document.getElementById("afterSchoolFields");

  document.querySelectorAll('input[name="pickupMethod"]').forEach(el => {
    el.addEventListener("change", function() {
      afterSchoolFields.style.display = (this.value === "安親班") ? "block" : "none";
    });
  });

  document.getElementById('studentForm').addEventListener('submit', function(e) {
    e.preventDefault();

    const formData = new FormData(this);
    const data = {};
    formData.forEach((value, key) => { data[key] = value });

    // 直接用你的 Apps Script 部署網址
    const scriptUrl = "https://script.google.com/macros/s/AKfycbyWZdeFxVuIKsNJs8M36LNxL-IwIivcWc9wEcCtu8mvqZ20YpbcIYHPFuGfzN_ytSST/exec";

    fetch(scriptUrl, {
      method: 'POST',
      body: JSON.stringify(data),
      headers: { 'Content-Type': 'application/json' }
    })
    .then(res => res.text())
    .then(() => {
      document.getElementById('successMessage').style.display = 'block';
      document.getElementById('studentForm').reset();
      afterSchoolFields.style.display = 'none';
    })
    .catch(err => console.error('送出失敗', err));
  });
});
</script>

</body>
</html>
