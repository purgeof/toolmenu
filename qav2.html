<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>115年 2年3班 調査表</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', 'Noto Sans TC', sans-serif;
            background-color: #f3f4f6;
        }

        /* 優化容器與間距 */
        .survey-card {
            max-width: 450px; /* 稍微縮窄，看起來更專業 */
            margin: auto;
            background: white;
            padding: 1.5rem 1.75rem; /* 縮減內部填充 */
            border-radius: 1rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        /* 標題優化 */
        .survey-title {
            font-size: 1.5rem; /* 縮小一點點 */
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 1.5rem;
            text-align: center;
            letter-spacing: -0.025em;
        }

        /* 區塊間距縮小 */
        .form-group {
            margin-bottom: 0.75rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid #f3f4f6; /* 加入淡分割線 */
        }
        .form-group:last-child { border-bottom: none; }

        .label-text {
            display: block;
            color: #374151;
            font-weight: 600;
            font-size: 0.95rem; /* 字體適中 */
            margin-bottom: 0.5rem;
        }

        /* 輸入框美化 */
        input[type="text"], input[type="tel"] {
            width: 100%;
            padding: 0.6rem 0.8rem;
            border-radius: 0.5rem;
            border: 1px solid #d1d5db;
            font-size: 0.95rem;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }
        input[type="text"]:focus, input[type="tel"]:focus {
            border-color: #14b8a6;
            ring: 2px;
            --tw-ring-color: rgba(20, 184, 166, 0.2);
            outline: none;
            box-shadow: 0 0 0 3px var(--tw-ring-color);
        }

        /* 自定義 radio button 樣式優化 */
        input[type="radio"] {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            width: 1.15rem;
            height: 1.15rem;
            border-radius: 50%;
            border: 2px solid #d1d5db;
            background-color: #fff;
            cursor: pointer;
            transition: all 0.2s;
            flex-shrink: 0;
            margin-top: 1px;
        }
        input[type="radio"]:checked {
            border-color: #14b8a6;
            border-width: 5px; /* 用邊框寬度模擬中心圓點，渲染更乾淨 */
        }
        
        .radio-label {
            display: flex;
            align-items: center;
            cursor: pointer;
            font-size: 0.95rem;
            color: #4b5563;
            padding: 0.25rem 0;
            transition: color 0.2s;
        }
        .radio-label:hover { color: #111827; }
        .radio-label span { margin-left: 0.6rem; }

        /* 安親班隱藏欄位優化 */
        .sub-fields {
            background-color: #f9fafb;
            padding: 0.75rem;
            border-radius: 0.5rem;
            margin-top: 0.5rem;
        }

        /* 按鈕美化 */
        .submit-btn {
            width: 100%;
            background-color: #14b8a6;
            color: white;
            font-weight: 600;
            padding: 0.8rem;
            border-radius: 0.6rem;
            font-size: 1.1rem;
            transition: all 0.2s;
            margin-top: 1rem;
            box-shadow: 0 4px 10px rgba(20, 184, 166, 0.3);
        }
        .submit-btn:hover {
            background-color: #0d9488;
            transform: translateY(-1px);
            box-shadow: 0 6px 15px rgba(20, 184, 166, 0.4);
        }
        .submit-btn:active { transform: translateY(0); }

        /* 彈窗樣式保持並細化 */
        #messageContainer {
            display: none;
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(2px);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            opacity: 0;
            transition: opacity 0.3s;
        }
        #messageContainer.show { opacity: 1; }
        .message-box {
            padding: 2rem;
            border-radius: 1rem;
            text-align: center;
            color: #fff;
            max-width: 300px;
            transform: scale(0.9);
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        #messageContainer.show .message-box { transform: scale(1); }
        .message-box.success { background: linear-gradient(135deg, #14b8a6, #0d9488); }
        .message-box.error { background: linear-gradient(135deg, #ef4444, #b91c1c); }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

    <div class="survey-card">
        <h1 class="survey-title">115年 2年3班 資料調査表</h1>
        
        <form id="qa1Form">
            <div class="form-group">
                <label class="label-text">1. 學生姓名</label>
                <input type="text" id="studentName" name="學生姓名" placeholder="輸入姓名" required>
            </div>

            <div class="form-group">
                <label class="label-text">2. 學生座號</label>
                <input type="tel" id="studentNumber" name="學生座號" placeholder="輸入座號" required>
            </div>

            <div class="form-group">
                <label class="label-text">3. 本學期午餐繳費方式</label>
                <div class="space-y-1">
                    <label class="radio-label">
                        <input type="radio" id="fullPayment" name="午餐繳費方式" value="全繳" required>
                        <span>全繳（與註冊費一起繳）</span>
                    </label>
                    <label class="radio-label">
                        <input type="radio" id="monthlyPayment" name="午餐繳費方式" value="月繳">
                        <span>月繳</span>
                    </label>
                    <label class="radio-label">
                        <input type="radio" id="subsidy" name="午餐繳費方式" value="領有午餐補助證明">
                        <span>領有午餐補助證明</span>
                    </label>
                    <label class="radio-label">
                        <input type="radio" id="myself" name="午餐繳費方式" value="午餐自理">
                        <span>午餐自理</span>
                    </label>
                </div>
            </div>

            <div class="form-group">
                <label class="label-text">4. 本學期午餐飲用的乳品</label>
                <div class="flex space-x-6">
                    <label class="radio-label">
                        <input type="radio" id="milk" name="午餐乳品" value="牛奶" required>
                        <span>牛奶</span>
                    </label>
                    <label class="radio-label">
                        <input type="radio" id="soymilk" name="午餐乳品" value="豆奶">
                        <span>豆奶</span>
                    </label>
                </div>
            </div>

            <div class="form-group">
                <label class="label-text">5. 本學期放學接送方式</label>
                <div class="space-y-1">
                    <label class="radio-label">
                        <input type="radio" id="parentPickup" name="放學接送方式" value="家長接送" required>
                        <span>家長接送</span>
                    </label>
                    <label class="radio-label">
                        <input type="radio" id="cramSchool" name="放學接送方式" value="安親班">
                        <span>安親班</span>
                    </label>
                    
                    <div id="cramSchoolFields" class="sub-fields hidden space-y-3">
                        <div>
                            <label for="cramSchoolName" class="text-xs text-gray-500 block mb-1">安親班名稱</label>
                            <input type="text" id="cramSchoolName" name="安親班-名稱" placeholder="請輸入名稱">
                        </div>
                        <div>
                            <label for="cramSchoolPhone" class="text-xs text-gray-500 block mb-1">安親班電話</label>
                            <input type="text" id="cramSchoolPhone" name="安親班-電話" placeholder="請輸入電話">
                        </div>
                    </div>

                    <label class="radio-label">
                        <input type="radio" id="afterSchoolCare" name="放學接送方式" value="課後照顧班">
                        <span>課後照顧班</span>
                    </label>
                </div>
            </div>

            <button type="submit" class="submit-btn">送出問卷</button>
        </form>
    </div>

    <div id="messageContainer">
        <div id="messageBox" class="message-box">
            <h2 id="messageTitle" class="text-xl font-bold mb-1"></h2>
            <p id="messageText" class="text-sm opacity-90"></p>
        </div>
    </div>

    <script>
        // --- 保持你原本的 JavaScript 邏輯不變 ---
        const formUrl = 'https://script.google.com/macros/s/AKfycby9fpO9ONFTyya38JylO42u1FuDREBKCCRis_EtmtxrTgmMJQOqJXqxbtefAGt-ec5N/exec';
        const form = document.getElementById('qa1Form');
        const cramSchoolRadio = document.getElementById('cramSchool');
        const cramSchoolFields = document.getElementById('cramSchoolFields');
        const cramSchoolNameInput = document.getElementById('cramSchoolName');
        const cramSchoolPhoneInput = document.getElementById('cramSchoolPhone');
        const messageContainer = document.getElementById('messageContainer');
        const messageBox = document.getElementById('messageBox');
        const messageTitle = document.getElementById('messageTitle');
        const messageText = document.getElementById('messageText');

        function toggleCramSchoolFields() {
            if (cramSchoolRadio.checked) {
                cramSchoolFields.classList.remove('hidden');
                cramSchoolNameInput.required = true;
                cramSchoolPhoneInput.required = true;
            } else {
                cramSchoolFields.classList.add('hidden');
                cramSchoolNameInput.required = false;
                cramSchoolPhoneInput.required = false;
                cramSchoolNameInput.value = '';
                cramSchoolPhoneInput.value = '';
            }
        }

        function showMessage(title, text, type) {
            messageTitle.textContent = title;
            messageText.textContent = text;
            messageBox.className = `message-box ${type}`;
            messageContainer.style.display = 'flex';
            setTimeout(() => { messageContainer.classList.add('show'); }, 10);
            setTimeout(() => {
                messageContainer.classList.remove('show');
                setTimeout(() => { messageContainer.style.display = 'none'; }, 300);
            }, 3000);
        }

        document.querySelectorAll('input[name="放學接送方式"]').forEach(radio => {
            radio.addEventListener('change', toggleCramSchoolFields);
        });

        toggleCramSchoolFields();

        form.addEventListener('submit', function(e) {
            e.preventDefault();
            const formData = {};
            new FormData(form).forEach((value, key) => { formData[key] = value; });
            showMessage('成功送出！', '感謝您的填寫。', 'success');
            form.reset();
            toggleCramSchoolFields();
            fetch(formUrl, {
                method: 'POST',
                body: JSON.stringify(formData),
                headers: { 'Content-Type': 'text/plain;charset=utf-8' },
            }).catch(error => {
                console.error('Error:', error);
                setTimeout(() => {
                    showMessage('發生錯誤', '請檢查網路連線。', 'error');
                }, 3500);
            });
        });
    </script>
</body>
</html>
